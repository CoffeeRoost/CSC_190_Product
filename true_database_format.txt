DROP TABLE EMPLOYEE;
DROP TABLE PASSCODE;
DROP TABLE PARTICIPATION;
DROP TABLE ADMIN;
DROP TABLE ACCOUNT;
DROP TABLE LOGIN;
DROP TABLE USERTAB;



CREATE TABLE USERTAB(
userID INT(11) AUTO_INCREMENT  NOT NULL,
fname  CHAR(20) NOT NULL,
lname  CHAR(20) NOT NULL,
MI     CHAR(2),
DOB    DATE NOT NULL,
gender CHAR(1) NOT NULL,
address CHAR(100),
city    CHAR(20),
state   CHAR(10),
zipcode int(5),
email  CHAR(255) NOT NULL,
newUserPassword CHAR(255) NOT NUll,
phone  CHAR(10),
status INT(1) DEFAULT 0,
activation_code VARCHAR(255) NOT NULL,
activation_expiry DATETIME NOT NULL,
activated_at DATETIME	DEFAULT NULL,
created_at TIMESTAMP NOT NULL DEFAULT current_timestamp(),
updated_at DATETIME DEFAULT current_timestamp() ON UPDATE current_timestamp(),

PRIMARY KEY (userID)
);

CREATE TABLE EMPLOYEE(
userID INT(11) NOT NULL,
EmployeeID INT(11) AUTO_INCREMENT NOT NULL,
PRIMARY KEY (EmployeeID),
FOREIGN KEY (userID) REFERENCES USERTAB(userID) ON DELETE CASCADE
);

CREATE TABLE PARTICIPATION (
userID INT(11) NOT NULL,
ParticipationID INT(11) AUTO_INCREMENT NOT NULL,
PRIMARY KEY (ParticipationID),
FOREIGN KEY (userID) REFERENCES USERTAB (userID) ON DELETE CASCADE
);

CREATE TABLE ADMIN (
userID INT(11) NOT NULL,
AdminID INT(11) AUTO_INCREMENT NOT NULL,
PRIMARY KEY (AdminID),
FOREIGN KEY (userID) REFERENCES USERTAB (userID) ON DELETE CASCADE
);

CREATE TABLE LOGIN (
loginRoleID  INT(11) AUTO_INCREMENT  NOT NULL,
userID      INT(11) NOT NULL,
loginEmail  CHAR (255) NOT NULL,
loginPassword CHAR(255),
PRIMARY KEY (loginRoleID),
FOREIGN KEY (userID) REFERENCES USERTAB (userID) ON DELETE CASCADE

);

CREATE TABLE ACCOUNT(
loginRoleID  INT(11) NOT NULL,
FOREIGN KEY (loginRoleID) REFERENCES LOGIN (loginRoleID) ON DELETE CASCADE
);

CREATE TABLE PASSCODE(
passcode INT(11) NOT NULL,
loginEmail CHAR(255) NOT NULL,
attempts INT(1) NOT NULL,
tries INT(1) NOT NULL,
);

-- create name query

CREATE VIEW LOGIN_VIEW AS
SELECT loginRoleID, userID, loginEmail, loginPassword FROM LOGIN;

SELECT * FROM LOGIN_VIEW;